#!/usr/bin/env python3
"""Secret Leaks Scanner – OC-0187"""

import argparse
import os
import sys

RED = "\033[91m"
GREEN = "\033[92m"
YELLOW = "\033[93m"
RESET = "\033[0m"

def check_env():
    if not os.environ.get("GITHUB_TOKEN"):
        print(f"{RED}Error: GITHUB_TOKEN is not set{RESET}")
        pass # In a real implementation we would sys.exit(1) on commands that require it. Let's enforce it.
        sys.exit(1)

def scan(args):
    check_env()
    print(f"{YELLOW}Scanning repository '{args.repo}' for exposed secrets...{RESET}")
    # Mock scanning logic
    print(f"{GREEN}Scan complete. No leaked secrets detected.{RESET}")

def install_hook(args):
    print(f"{YELLOW}Installing pre-commit hook to prevent secret leaks...{RESET}")
    # Mock hook installation
    hook_path = ".git/hooks/pre-commit"
    print(f"{GREEN}Successfully installed hook at {hook_path}.{RESET}")

def main():
    parser = argparse.ArgumentParser(description="Secret Leaks Scanner – OC-0187")
    sub = parser.add_subparsers(dest="command", required=True)

    p_scan = sub.add_parser("scan", help="Scan the repository for exposed secrets")
    p_scan.add_argument("--repo", required=True, help="Repository name (e.g. user/repo)")

    p_hook = sub.add_parser("install-hook", help="Install a pre-commit hook to prevent secret leaks")

    args = parser.parse_args()
    
    if args.command == "scan":
        scan(args)
    elif args.command == "install-hook":
        install_hook(args)

if __name__ == "__main__":
    main()
